<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@frankbille">
    <meta name="twitter:title" content="Using Twitter for blog comments">
    <meta name="twitter:description" content="Static link to Twitter for blog comments, instead of embedding">
    <title>Using Twitter for blog comments</title>
    <style>
      code[class*=language-],pre[class*=language-]{color:#111b27;font-size:.95em;background:0 0;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{border:1px dashed #000}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{border:1px dashed #000}pre[class*=language-]{padding:1em;margin:3em 4em;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{border:1px dashed #000}@media (max-width:1280px){pre[class*=language-]{width:calc(650px + 8em)}}@media (max-width:1024px){pre[class*=language-]{width:calc(380px + 8em)}}@media (max-width:780px){pre[class*=language-]{width:340px;margin-left:0;margin-right:0}}:not(pre)>code[class*=language-]{padding:.1em .3em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#3c526d}.token.punctuation{color:#111b27}.token.delimiter.important,.token.selector .parent,.token.tag,.token.tag .token.punctuation{color:#006d6d}.token.attr-name,.token.boolean,.token.boolean.important,.token.constant,.token.number,.token.selector .token.attribute{color:#755f00}.token.class-name,.token.key,.token.parameter,.token.property,.token.property-access,.token.variable{color:#005a8e}.token.attr-value,.token.color,.token.inserted,.token.selector .token.value,.token.string,.token.string .token.url-link{color:#116b00}.token.builtin,.token.keyword-array,.token.package,.token.regex{color:#af00af}.token.function,.token.selector .token.class,.token.selector .token.id{color:#7c00aa}.token.atrule .token.rule,.token.combinator,.token.keyword,.token.operator,.token.pseudo-class,.token.pseudo-element,.token.selector,.token.unit{color:#a04900}.token.deleted,.token.important{color:#c22f2e}.token.keyword-this,.token.this{color:#005a8e}.token.bold,.token.important,.token.keyword-this,.token.this{font-weight:700}.token.delimiter.important{font-weight:inherit}.token.italic{font-style:italic}.token.entity{cursor:help}.language-markdown .token.title,.language-markdown .token.title .token.punctuation{color:#005a8e;font-weight:700}.language-markdown .token.blockquote.punctuation{color:#af00af}.language-markdown .token.code{color:#006d6d}.language-markdown .token.hr.punctuation{color:#005a8e}.language-markdown .token.url>.token.content{color:#116b00}.language-markdown .token.url-link{color:#755f00}.language-markdown .token.list.punctuation{color:#af00af}.language-json .token.operator,.language-markdown .token.table-header{color:#111b27}.language-scss .token.variable{color:#006d6d}.token.cr:before,.token.lf:before,.token.space:before,.token.tab:not(:empty):before{color:#3c526d}div.code-toolbar>.toolbar a,div.code-toolbar>.toolbar button{color:#e3eaf2;background:#005a8e}div.code-toolbar>.toolbar a:focus,div.code-toolbar>.toolbar a:hover,div.code-toolbar>.toolbar button:focus,div.code-toolbar>.toolbar button:hover{color:#e3eaf2;background:#005a8eda;text-decoration:none}div.code-toolbar>.toolbar span,div.code-toolbar>.toolbar span:focus,div.code-toolbar>.toolbar span:hover{color:#e3eaf2;background:#3c526d}.line-highlight{background:#8da1b92f;background:linear-gradient(to right,#8da1b92f 70%,#8da1b925)}.line-highlight:before,.line-highlight[data-end]:after{background-color:#3c526d;color:#e3eaf2;box-shadow:0 1px #8da1b9}pre[id].linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:#3c526d1f}.line-numbers .line-numbers-rows{border-right:1px solid #8da1b97a;background:#d0dae77a}.line-numbers-rows>span:before{color:#3c526dda}.rainbow-braces .token.punctuation.brace-level-1,.rainbow-braces .token.punctuation.brace-level-5,.rainbow-braces .token.punctuation.brace-level-9{color:#755f00}.rainbow-braces .token.punctuation.brace-level-10,.rainbow-braces .token.punctuation.brace-level-2,.rainbow-braces .token.punctuation.brace-level-6{color:#af00af}.rainbow-braces .token.punctuation.brace-level-11,.rainbow-braces .token.punctuation.brace-level-3,.rainbow-braces .token.punctuation.brace-level-7{color:#005a8e}.rainbow-braces .token.punctuation.brace-level-12,.rainbow-braces .token.punctuation.brace-level-4,.rainbow-braces .token.punctuation.brace-level-8{color:#7c00aa}pre.diff-highlight>code .token.deleted:not(.prefix),pre>code.diff-highlight .token.deleted:not(.prefix){background-color:#c22f2e1f}pre.diff-highlight>code .token.inserted:not(.prefix),pre>code.diff-highlight .token.inserted:not(.prefix){background-color:#116b001f}.command-line-prompt{border-right:1px solid #8da1b97a}.command-line-prompt>span:before{color:#3c526dda}body{margin:0;font-family:monospace;min-height:100vh;display:flex;flex-direction:column}header{position:fixed;display:flex;width:100vw;justify-content:center;align-items:center;height:4em;background-color:#fafafa;border-bottom:thick ridge #a3b3c3;border-bottom-left-radius:.3em;border-bottom-right-radius:.3em}header .title a{margin:0 4em 0 0;padding:0;font-size:large;font-weight:700;height:4em;display:flex;align-items:center;color:#000;text-decoration:none}header nav ul{display:flex;justify-content:center;align-items:center;padding:0;margin:0;height:4em}header nav ul li{display:block;font-size:large;margin-left:2em}header nav ul li a{color:#000;margin-left:2em}header nav ul li a:hover,main a:hover{text-decoration-color:red;background-color:#000;color:#fff}main{margin-top:4em;display:flex;flex-direction:column;align-self:center;max-width:1234px;padding:2em 4em 3em}main a{color:#000}main h1{font-size:2em}main article{font-size:1.25em}main article .post-meta{display:flex;justify-content:space-between;margin-bottom:3em}main article h2{font-size:1.1em;display:flex;align-items:center;margin-top:2em;margin-bottom:2em}main article h2:before{border-top:1px dashed #000;border-bottom:1px dashed #000;height:2px;content:' ';margin-right:1em;width:2em}main article h2:after{flex-grow:1;border-top:1px dashed #000;border-bottom:1px dashed #000;height:2px;content:' ';margin-left:1em}main article h3{font-size:1em;display:flex;align-items:center;margin-top:2em;margin-bottom:2em}main article h3:before{border-bottom:1px dashed #a9a9a9;content:' ';margin-right:1em;width:1em}main article ol,main article ul{margin-top:3em;margin-bottom:3em;padding-inline-start:4em;padding-inline-end:4em}main article ol li,main article ul li{margin-top:1em}main article :not(pre)>code{background-color:#f5f5f5}main article .twitter-link{border-top:1px solid #a9a9a9;margin-top:4em;padding-top:2em}footer{margin-top:auto;display:flex;justify-content:center;align-items:center;height:3em;background-color:#fafafa;border-top:thick ridge #a3b3c3;border-top-left-radius:.3em;border-top-right-radius:.3em}footer a{color:#000;margin-left:2em}footer a:hover{text-decoration-color:red;background-color:#000;color:#fff}@media (max-width:480px){pre[class*=language-]{width:220px;margin-left:0;margin-right:0}header{justify-content:space-between;flex-direction:column;height:auto}header .title a{margin-right:0;height:2em}header nav{width:100%}header nav ul{height:2em;justify-content:space-evenly}header nav ul li,header nav ul li a{margin-left:0}main article ol,main article ul{padding-inline-start:1em;padding-inline-end:0}}@media print{footer,header{display:none}main{margin-top:0;padding-top:0;padding-bottom:0}}
    </style>
  </head>
  <body>
    <header>
      <div class="title"><a href="/">Frank Bille-Stauner</a></div>
      <nav>
        <ul>
          <li><a href="/">Blog</a></li>
          <li><a href="/about">About</a></li>
        </ul>
      </nav>
    </header>

    <main>
      
<article class="post"> 
    <h1>Using Twitter for blog comments</h1>
    <div class="post-meta">
        <time datetime="2021-07-13">July 13, 2021</time>
        <div>4 min. read</div>
    </div>

    <p>I have wanted to support comments on my blog posts but was unsure how to do that best, with my No JavaScript promise.
It might have been possible to find a solution that used <code>&lt;iframe /&gt;</code>, but that required loading in from another
site, including JavaScript, and wasn't that cheating? ü§î</p>
<p>No, the answer had to be simpler, so I decided to use Twitter for comment. It should be as simple as this:</p>
<ol>
<li>Create a blog post about <a href="https://www.frankbille.dk/blog/2021-06-08-new-website/">something</a> üíØ</li>
<li>Post a status update on Twitter üíå</li>
<li>Take the Tweet link and add it to the blog post üëè</li>
</ol>
<p>If anyone ever feels like commenting, they can click the link at the bottom of the blog post and reply
to my tweet. Easy Peasy!</p>
<h2>Make Twitter comment links part of the template</h2>
<p>I didn't want to manually add the Twitter link to all blog posts and ensuring that it looked consistent.
Luckily I'm using <a href="https://11ty.dev">Eleventy</a>, and I've already got some templates going. Adding support on
the template level was very easy.</p>
<p>First, I updated my <a href="https://github.com/frankbille/frankbille.github.io/blob/source/_includes/layouts/post.njk">blog post template</a> and added this small section:</p>
<pre class="language-twig"><code class="language-twig"><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">if</span></span> <span class="token property">twitterLink</span> <span class="token rd"><span class="token punctuation">%}</span></span></span><br><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>twitter-link<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    &lt;a href="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">twitterLink</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" title="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">twitterComment</span> <span class="token operator">|</span> <span class="token property">safe</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" target="_blank">Comment on this blog post on Twitter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span><br><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">endif</span></span> <span class="token rd"><span class="token punctuation">%}</span></span></span></code></pre>
<p>And then I only have to add a <code>twitterLink</code> property to the front matter data on the blog post, like this:</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><br><span class="token key atrule">layout</span><span class="token punctuation">:</span> post<br><span class="token key atrule">title</span><span class="token punctuation">:</span> New website made with Eleventy<br><span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-06-08</span><br><span class="token key atrule">tags</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><br><span class="token key atrule">excerpt</span><span class="token punctuation">:</span> I have created this new website using Eleventy<br><span class="token key atrule">twitterLink</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//twitter.com/frankbille/status/1414993301472747524<br><span class="token punctuation">---</span></code></pre>
<p>A nice and easy solution, and I'm sure I will remember to post to Twitter whenever I make a new blog
post. One single step, easy to remember. üëã</p>
<p>Oh, and of cause then update the code for the blog post to add the <code>twitterLink</code> property and push it
again. Easy Peasy!</p>
<h2>Automatically post to Twitter and add the twitterLink</h2>
<p>Yeah, knowing myself, I'm not going to remember to do that. I've been around me long enough to know
most of my strengths and weaknesses. Fortunately, I'm in tech, and I love making computers do what they are good at, and I'm bad at, like following a script precisely and consistently!</p>
<p>So with the help of <a href="https://github.com/jonschlinkert/gray-matter">gray-matter</a> (handling the meta-data in my templates),
<a href="https://github.com/PLhery/node-twitter-api-v2">Twitter API v2</a> (posting tweets and getting the status id back) and
<a href="https://www.npmjs.com/package/@nodelib/fs.walk">fs.walk</a> (easily find all my blog posts on the file system), I created <a href="https://github.com/frankbille/frankbille.github.io/blob/source/.github/scripts/add-twitter-link.js">a small script</a> to be run
on all commits. It finds blog posts, that hasn't been posted to Twitter yet, posts a status update and
inserts <code>twitterLink</code> in the post file.</p>
<p>This is being called from my <a href="https://github.com/frankbille/frankbille.github.io/blob/source/.github/workflows/eleventy_build.yml">GitHub Actions script</a>, which afterwards pushes the
changes to the blog post files back to the GitHub Repository, using the cool <a href="https://github.com/marketplace/actions/add-commit">Add &amp; Commit</a>
action.</p>
<p>It even supports custom Twitter status text, if I set the <code>twitterComment</code> property in the post file.
In the unlikely event I forget to set <code>twitterComment</code>, it will fallback to the <code>excerpt</code> property
and finally the <code>title</code> property.</p>
<p>Only thing left to say is: I hope the script works and if it does there should be a Twitter link below
üëáüëáüëáü§ûü§ûü§û</p>



    
</article>

    </main>

    <footer>
      <div>&copy; 2000-2021</div>
      <a href="https://github.com/frankbille/frankbille.github.io/edit/source/./blog/2021-07-13-twitter-comments/index.md">Edit this page on GitHub</a>
    </footer>
  </body>
</html>
